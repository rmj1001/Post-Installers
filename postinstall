#!/usr/bin/env bash

##############################################
#   Author: RMCJ <rmichael1001@gmail.com>
#   Project: com.github.rmj1001.Post-Installers
#   Version: 1.0
#
#   Usage: postinstall
#
#   Description:
#		Curlable Postinstallation Script
##############################################

function PRINT() { printf "%b\n" "${@}"; }
function LINES() {
    for ((i = 0; i < COLUMNS; ++i)); do printf -; done
    PRINT
}
# Description: Pauses script execution until the user presses ENTER
# Usage:  PAUSE
# Returns: int
function PAUSE() {
    NPRINT "Press <ENTER> to continue..."
    read -r
}
function LOWERCASE() {
    printf "%b" "${1}" | tr "[:upper:]" "[:lower:]"
}
function FINDCMD() {
    [[ -x "$(command -v ${1})" ]] && return 0
    return 1
}

function REQUIRECMD() {
    local metRequirements=0

    for cmd in "${@}"; do
        FINDCMD "${cmd}" && continue
        PRINT "Missing Dependency: ${cmd}"
        metRequirements=1
    done

    [[ $metRequirements -eq 0 ]] && return 0
    return 1
}

function ctrl_c() {
    PRINT "\n"
    [[ -z "${scriptNumber}" ]] && PRINT "Canceling."
    PRINT
    exit 0
}

trap ctrl_c INT

INSTALLERS_DISTROS="https://raw.githubusercontent.com/rmj1001/Post-Installers/main/distros"
INSTALLERS_MISC="https://raw.githubusercontent.com/rmj1001/Post-Installers/main/misc"

clear

PRINT "
 ######                         ###                                             #     #                                    
 #     #  ####   ####  #####     #  #    #  ####  #####   ##   #      #         #     # ###### #      #####  ###### #####  
 #     # #    # #        #       #  ##   # #        #    #  #  #      #         #     # #      #      #    # #      #    # 
 ######  #    #  ####    #       #  # #  #  ####    #   #    # #      #         ####### #####  #      #    # #####  #    # 
 #       #    #      #   #       #  #  # #      #   #   ###### #      #         #     # #      #      #####  #      #####  
 #       #    # #    #   #       #  #   ## #    #   #   #    # #      #         #     # #      #      #      #      #   #  
 #        ####   ####    #      ### #    #  ####    #   #    # ###### ######    #     # ###### ###### #      ###### #    # 
"
LINES
PRINT
PRINT "Choose One (type the id number) and press ENTER:"
PRINT "(Leave empty to cancel)"
PRINT
PRINT "-----------------------"
PRINT "Distros"
PRINT "-----------------------"
PRINT "d1. Fedora"
PRINT "d2. Ubuntu"
PRINT ""
PRINT "-----------------------"
PRINT "Miscellaneous Software"
PRINT "-----------------------"
PRINT "m1. Flatpaks"
PRINT "m2. Homebrew"
PRINT "m3. Papirus Icons"
PRINT "m4. Zap (AppImage manager)"
PRINT "m5. Doas (sudo alternative)"
PRINT "m6. Tmpmail (Temporary email adress)"
PRINT "m7. Nvm (Node Version Manager)"
PRINT
read -r -p "ID > " scriptNumber

case "${scriptNumber}" in

d1 | fedora)
    LINES
    bash <(wget -qO- "${INSTALLERS_DISTROS}/fedora.sh")
    exit 0
    ;;

d2 | ubuntu)
    LINES
    bash <(wget -qO- "${INSTALLERS_DISTROS}/ubuntu.sh")
    exit 0
    ;;

m1 | flatpaks)
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/flatpak.sh")
    exit 0
    ;;

m2 | homebrew)
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/homebrew.sh")
    exit 0
    ;;

m3 | 'papirus icons')
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/papirus.sh")
    exit 0
    ;;

m4 | zap)
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/zappm.sh")
    exit 0
    ;;

m5 | doas)
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/doas.sh")
    exit 0
    ;;

m6 | tmpmail)
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/tmpmail.sh")
    exit 0
    ;;

m7 | nvm)
    LINES
    bash <(wget -qO- "${INSTALLERS_MISC}/nvm.sh")
    exit 0
    ;;

*)
    PRINT
    [[ -z "${scriptNumber}" ]] && PRINT "Canceling."
    [[ -n "${scriptNumber}" ]] && PRINT "Invalid option '${scriptNumber}'. Aborting."
    PRINT
    exit 0
    ;;
esac
